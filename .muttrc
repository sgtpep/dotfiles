set `bash -eu -c 'path=~/.cache/mutt; [[ -d "$path" ]] || mkdir -p "$path"; echo -n "tmpdir=$path "; while IFS= read -r line; do pattern="\bmachine\s+(mail\..+)\s+login\s+(.+)\s+password\s+(.+)"; if [[ $line =~ $pattern ]]; then hostname=${BASH_REMATCH[2]}:${BASH_REMATCH[3]}@${BASH_REMATCH[1]}; echo "from=${BASH_REMATCH[2]} folder=imaps://$hostname smtp_url=smtps://$hostname"; fi; done < ~/.netrc'`
set imap_idle
set postponed==Drafts
set record==Sent
set spoolfile==Inbox
mailboxes $spoolfile

set mail_check=60
set sleep_time=0
set timeout=10

set noabort_nosubject
set noabort_unmodified
set nohelp
set noimap_passive
set nomarkers
set nowait_key

set beep_new
set fast_reply
set forward_format=Fw:\ %s
set from='Danil Semelenov <mail'@'danil.mobi>'
set header_cache=~/.cache/mutt
set include
set mime_forward
set pager_stop
set query_command='echo; sed -n '\''s/\(.*'\''%s'\''.*\) <\(.*\)>/\2\t\1/ip; s/\(.*\) <\(.*'\''%s'\''.*\)>/\2\t\1/ip'\'' ~/notes/emails'
set rfc2047_parameters
set text_flowed
set wrap=80

alternative_order text/plain text/html
auto_view text/html

bind editor <Tab> complete-query
bind index g reply
bind index r group-reply

macro attach s '<save-entry><kill-line>~/Downloads/<Return>y<Return>'
macro index <Space>a '<change-folder>=Archive<Return>'
macro index <Space>e '<change-folder>=Inbox<Return>'
macro index <Space>f '<change-folder>=Feeds<Return>'
macro index <Space>s '<change-folder>=Spam<Return>'
macro index <Space>t '<change-folder>=Trash<Return>'
macro index,pager A '<save-message>=Archive<Return><Return>'
macro index,pager b '<view-attachments><search>text/html<Return><view-mailcap><exit><delete-message>'
macro pager d '<delete-message><exit>'

folder-hook . 'bind index D noop'
folder-hook . 'bind index,pager F flag-message'
folder-hook . 'bind index,pager f forward-message'
folder-hook . 'push <first-entry>'
folder-hook . 'set index_format="%3C %Z %{%b %d} %-15.15L (%?l?%4l&%4c?) %s"'
folder-hook . 'set sort=reverse-date-received'
folder-hook . 'set trash==Trash'

folder-hook Feeds 'macro index D <first-entry><delete-pattern>~m-10<Return><sync-mailbox><Return>'
folder-hook Feeds 'macro index,pager F <forward-message>'
folder-hook Feeds 'macro index,pager f <pipe-message>"clear && grep -Po '\''(?<=\^X-RSS-URL: ).+'\'' >> ~/.urls"<Return>'
folder-hook Feeds 'set index_format="%3C %-12.12L  %s"'
folder-hook Feeds 'set sort=date-received'
folder-hook Feeds|Trash 'unset trash'

color attachment default default
color hdrdefault default default
color indicator black white
color markers default default
color normal default default
color quoted default default
color signature default default
color status default default
color tilde default default
color tree default default
