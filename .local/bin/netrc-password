#!/bin/bash
set -eu
[[ -f ~/.netrc ]] || scp personal:.netrc ~/.netrc
while IFS= read -r line; do
  regex="^machine ${1//./\\.} login ${2//./\\.} password ([^ ]+)"
  if [[ $line =~ $regex ]]; then
    echo "${BASH_REMATCH[1]}"
    break
  fi
done < ~/.netrc
