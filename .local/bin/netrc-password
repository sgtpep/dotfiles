#!/bin/bash
set -eu
[[ -f ~/.netrc || -f /etc/netrc ]] || scp personal:.netrc ~/.netrc
path=~/.netrc
[[ -f $path ]] || path=/etc/netrc
while IFS= read -r line; do
  regex="^machine ${1//./\\.} login ${2//./\\.} password ([^ ]+)"
  if [[ $line =~ $regex ]]; then
    echo "${BASH_REMATCH[1]}"
    break
  fi
done < "$path"
