#!/bin/bash
set -eu
local=~/.netrc
system=/etc/netrc
[[ -f $local || -f $system ]] || scp personal:"${local##*/}" "$local"
path=$local
[[ -f $path ]] || path=$system
while IFS= read -r line; do
  regex="^machine ${1//./\\.} login ${2//./\\.} password ([^ ]+)"
  if [[ $line =~ $regex ]]; then
    echo "${BASH_REMATCH[1]}"
    break
  fi
done < "$path"
