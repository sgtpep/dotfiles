#!/bin/bash
set -eu
path=~/.netrc
[[ -f $path ]] || scp personal:"${path#~/}" "$path"
if [[ $@ ]]; then
  while IFS= read -r line; do
    pattern="^machine ${1//./\\.} login ${2//./\\.} password ([^ ]+)"
    if [[ $line =~ $pattern ]]; then
      echo "${BASH_REMATCH[1]}"
      break
    fi
  done < "$path"
fi
