#!/bin/bash
set -eu
while :; do
  output=$(rlwrap -o -C "${0##*/}" -P '' -S "${1##*/}> " -b '' -g '^ ' -q '([' -s 10000 -w 0 cat)
  if [[ $output ]]; then
    node -e "
$(< "$1")
console.log($output);
" |& less
  else
    echo
    break
  fi
done
