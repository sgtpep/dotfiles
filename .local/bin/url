#!/bin/bash
set -eu

url=$(sed 's/^\s\+\|\s\+$//g' <<< "$1")
[[ $url =~ ^https?://[^[:space:]]+$ ]] 

title=$(
  wget -q -O - -U 'Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0' --header='Accept-Encoding: gzip' --no-check-certificate "$url" | \
  gunzip -f | \
  grep -Pio -m 1 '[^>]*(?=</title>)' | \
  tr '\0' ' ' | \
  w3m -T text/html -dump | \
  tr '\n' ' ' | \
  sed 's/\s\+/ /g; s/^ \| $//'
)
echo "${title:+$title }$url" 
