#!/bin/bash
set -eu
declare -A commands=(
  [application/msword]='libreoffice "$1"'
  [application/pdf]='mupdf "$1"'
  [application/vnd.ms-excel]='libreoffice "$1"'
  [application/vnd.openxmlformats-officedocument.spreadsheetml.sheet]='libreoffice "$1"'
  [application/vnd.openxmlformats-officedocument.wordprocessingml.document]='libreoffice "$1"'
  [audio/*]='mpv -- "$1"'
  [image/*]='sxiv -- "$1"'
  [image/svg+xml]='x-www-browser -- "$1"'
  [text/html]='x-www-browser -- "$1"'
  [text/rtf]='libreoffice "$1"'
  [video/*]='mpv -- "$1"'
)
if [[ $1 =~ ^https?:// ]]; then
  exec x-www-browser -- "$1"
else
  mime=$(file -b --mime-type -- "$1")
  command=${commands[$mime]-${commands[${mime%/*}/*]-}}
  if [[ $command ]]; then
    eval "exec $command"
  else
    echo "Unknown mime type: $mime" >&2
    exit 1
  fi
fi
