#!/bin/bash
set -eu
command=(ping -c 1 danil.mobi)
if [[ $1 == block ]] || ! "${command[@]}" &> /dev/null; then
  executable=rfkill
  if [[ -c /dev/$executable ]]; then
    [[ -x /usr/sbin/$executable ]] || install-packages "$executable"
    sudo "$executable" "$1" wifi
  fi
  if [[ $1 == unblock ]]; then
    echo -n 'Connecting...' >&2
    until "${command[@]}" &> /dev/null; do
      sleep 1
    done
    echo >&2
  fi
fi
