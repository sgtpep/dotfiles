#!/bin/bash
set -eu
directory=~/.config/chromium
key=content_settings
path=$directory/Default/Preferences
[[ -h $directory/SingletonLock || $(< "$path") != *"\"$key\":[{"* ]] || sed -i 's/\("'"$key"'":\[\){[^]]*\(]\)/\1\2/' "$path"
[[ -f ~/.job ]] || set -- --disable-notifications "$@"
set -- /usr/bin/"${0##*/}" --disable-infobars --disable-smooth-scrolling --enable-native-notifications --load-extension=/usr/share/chromium/extensions/ublock-origin "$@"
[[ -x $1 ]] || install-packages "${0##*/}" webext-ublock-origin
exec "$@"
