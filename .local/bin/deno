#!/bin/bash
set -eu
checksum=7705fd832a05b2a2d5fc1e5bce6a9009ef295217103ddb7139aaafad8986c458
version=1.0.2
command=${0##*/}
set -- "$DENO_HOME"/bin/"$command" "$@"
if [[ ! -x $1 ]]; then
  url=https://github.com/denoland/deno/releases/download/v$version/deno-x86_64-unknown-linux-gnu.zip
  path=/tmp/${url##*/}
  wget -O "$path" "$url" || rm -f "$path"
  sha256sum -c <<< "$checksum $path"
  directory=${1%/*}
  mkdir -p "$directory"
  unzip "$path" deno -d "$directory"
fi
exec "$@"
